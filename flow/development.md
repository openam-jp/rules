# 開発手順

OpenAM コンソーシアムの開発メンバーが不具合の修正もしくは新規機能の開発を行う際の手順を記載する。

## 手順一覧

1. [Issue を作成する](#1-issue-を作成する)
2. [担当者のアサイン](#2-担当者のアサイン)
3. [ブランチを作成する](#3-ブランチを作成する)
4. [コードを書いてコミットする](#4-コードを書いてコミットする)
5. [プルリクエストを作成する](#5-プルリクエストを作成する)
6. [レビューを受ける](#6-レビューを受ける)
7. [レビューの結果を反映する](#7-レビューの結果を反映する)
8. [レビューが完了すると修正がマージされる](#8-レビューが完了すると修正がマージされる)
9. [ブランチを削除する](#9-ブランチを削除する)

## 1. Issue を作成する

まずは Issue を作成して問題を共有する。

GitHub の Issue タブで `New issue` を押下する。

`Title` には Issue の概要、`Comment` には以下の項目を記載すること。

 * Description
   * Issue の内容を記載する
 * Steps to reproduce
   * 再現手順を記載する
 * Expected Results
   * 期待する結果を記載する
 * Actual Results
   * 実際の結果を記載する
 * Enviroment
   * 環境に依存する場合に OS やブラウザーのバージョンを記載する
 * Debug Log
   * OpenAM のデバッグログにエラーが出力されている場合に記載する

## 2. 担当者のアサイン

開発者は Issue 上で自身をアサインする。

アサイン後は Issue 上で修正方針を決定する。

## 3. ブランチを作成する

master ブランチから Issue 用のブランチを作成する。

```
git checkout -b issues/<issue番号>-<title>
```

## 4. コードを書いてコミットする

作成したブランチ上でコードを修正していく。

作業中のコミットの粒度は問わないが、レビューを考慮すること。
（最終的にプルリクエストをマージする際に `1 Issue = 1 コミット` となるように `Squash and merge` を行う。）

コミットログは以下のフォーマットとする。`Long Description` は箇条書きでもよい。

```
Short Description

Long Description(Optional)
```

## 5. プルリクエストを作成する

ローカルのブランチをリモートにプッシュする。

```
git push origin issues/<Issue番号>-<title>
```

GitHub でブランチを表示し、`New pull request` を押下してプルリクエストを作成する。

`Title` のフォーマットは `Issue #<Issue番号> <title>` とする。

`Comment` には以下の項目を記載すること。
Issue 上で言及している場合はその旨を記載する。

 * Analysis
   * 問題の根本原因
 * Solution
   * 修正方法
 * Install/Update
   * 修正の適用方法
   * サービススキーマの修正など、単純なモジュール差し替えでは適用できない場合に記載する
 * Compatibility
   * HTTP ステータスコードの変更など外部仕様に変更がある場合に記載する
 * Performance
   * 性能に与える影響
   * 性能劣化が懸念される場合に記載する
 * I18N
   * 国際化対応
   * エラーメッセージの文言を変更した場合など他言語に注意が必要な場合に記載する
 * Testing
   * 修正を確認するために必要なテスト内容
 * Regression testing
   * リグレッションテストの内容

`Assignees` には自身を設定すること。

`Reviewers` には次のメンバーを追加する

 * OGIS 多田
 * OSSTech 辻口

## 6. レビューを受ける

プルリクエストのレビューを受ける。

プルリクエストが放置されている場合はプルリクエストでのメンションや、Slack のダイレクトメッセージで通知する。

## 7. レビューの結果を反映する

レビューで指摘が有った場合は修正を行い、再度ブランチをリモートにプッシュする。

```
git add target
git commit
git push origin issues/<Issue番号>-<title>
```

## 8. レビューが完了すると修正がマージされる

レビューが完了するとレビューアーがマージを行う。

## 9. ブランチを削除する

プルリクエストがマージされたらリモートブランチを削除する。


